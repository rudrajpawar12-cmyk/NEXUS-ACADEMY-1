<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Academy | Study Timer</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        :root {
            --primary: #0070f3; --primary-soft: #eff6ff;
            --bg: #f8fafc; --sidebar: #ffffff;
            --text-main: #1e293b; --text-muted: #64748b;
            --border: #e2e8f0; --white: #ffffff;
            --success: #10b981; --danger: #ef4444; --warning: #f6c23e;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text-main); display: flex; height: 100vh; overflow: hidden; }

        /* --- SIDEBAR --- */
        .sidebar { width: 260px; background: var(--white); border-right: 1px solid var(--border); display: flex; flex-direction: column; height: 100vh; }
        .logo { padding: 25px; font-size: 1.4rem; font-weight: 800; color: var(--primary); text-decoration: none; display: flex; align-items: center; gap: 10px; }
        
        .nav-container { flex: 1; overflow-y: auto; padding: 0 25px 25px 25px; display: flex; flex-direction: column; }
        .nav-container::-webkit-scrollbar { width: 4px; }
        .nav-container::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }

        .nav-label { font-size: 0.75rem; font-weight: 700; color: var(--text-muted); text-transform: uppercase; margin: 20px 0 10px 0; display: block; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px 15px; border-radius: 10px; color: var(--text-main); text-decoration: none; font-weight: 500; margin-bottom: 5px; transition: 0.2s; }
        .nav-item:hover { background: var(--primary-soft); color: var(--primary); }
        .nav-item.active { background: var(--primary); color: white; }

        /* --- MAIN CONTENT (TIMER) --- */
        .main-content { flex: 1; padding: 40px; overflow-y: auto; display: flex; justify-content: center; align-items: center; }
        
        .timer-panel {
            width: 100%; max-width: 450px;
            background: var(--white); border-radius: 30px;
            border: 1px solid var(--border); padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.05); text-align: center;
        }

        #modeText { text-transform: uppercase; letter-spacing: 2px; font-size: 14px; font-weight: 700; color: var(--text-muted); }
        .timer { font-size: 85px; margin: 10px 0; font-weight: 800; color: var(--text-main); font-variant-numeric: tabular-nums; }
        
        .pulse { animation: pulse-red 0.6s infinite alternate; }
        @keyframes pulse-red { from { transform: scale(1); } to { transform: scale(1.02); color: var(--danger); } }

        .progress-container { height: 12px; background: #eee; border-radius: 10px; margin: 20px 0 30px 0; overflow: hidden; }
        .bar { height: 100%; width: 0%; background: var(--primary); transition: width 1s linear; }

        .controls { display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 12px; }
        button { padding: 15px; border: none; border-radius: 15px; cursor: pointer; font-weight: 700; transition: 0.2s; }
        button:active { transform: scale(0.95); }
        .btn-start { background: var(--primary); color: white; }
        .btn-pause { background: var(--warning); color: white; }
        .btn-reset { background: #f1f5f9; color: var(--text-muted); }

        .settings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border); }
        label { font-size: 11px; font-weight: 800; color: var(--text-muted); text-transform: uppercase; display: block; margin-bottom: 8px; }
        input[type=number] { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid var(--border); text-align: center; font-weight: 700; }

        /* --- RIGHT PANEL --- */
        .right-panel { width: 320px; background: var(--white); border-left: 1px solid var(--border); padding: 25px; }
        .stats-box { background: var(--primary-soft); padding: 20px; border-radius: 20px; margin-bottom: 20px; text-align: center; }
        .stat-val { font-size: 1.6rem; font-weight: 800; color: var(--primary); display: block; }

        .toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-150px);
            background: var(--text-main); color: white; padding: 15px 35px;
            border-radius: 50px; font-weight: 600; transition: 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28); z-index: 2000;
        }
        .toast.show { transform: translateX(-50%) translateY(0); }
    </style>
</head>
<body>

    <div class="toast" id="toast">Let's Focus!</div>

    <aside class="sidebar">
        <a href="dashboard.html" class="logo"><i class="fa-solid fa-graduation-cap"></i> NEXUS</a>
        <div class="nav-container">
            <span class="nav-label">Learn</span>
            <a href="dashboard.html" class="nav-item"><i class="fa-solid fa-house"></i> Dashboard</a>
            <a href="MyCourses.html" class="nav-item"><i class="fa-solid fa-play"></i> My Courses</a>
            <a href="Assignments.html" class="nav-item"><i class="fa-solid fa-list-check"></i> Assignments</a>
            
            <span class="nav-label">Practice</span>
            <a href="MockTests.html" class="nav-item"><i class="fa-solid fa-vial"></i> Mock Tests</a>
            <a href="PastPapers.html" class="nav-item"><i class="fa-solid fa-file-pen"></i> Past Papers</a>
            
            <span class="nav-label">Tools</span>
            <a href="reminder.html" class="nav-item active"><i class="fa-solid fa-stopwatch"></i> Study Timer</a>
            <a href="planner.html" class="nav-item"><i class="fa-solid fa-calendar"></i> Planner</a>
            <div style="margin-top: auto; padding-top: 20px;">
                <span class="nav-label">Settings</span>
                <a href="profile.html" class="nav-item"><i class="fa-solid fa-user-circle"></i> User Profile</a>
            </div>
        </div>
    </aside>

    <main class="main-content">
        <div class="timer-panel">
            <p id="modeText">Focus Session</p>
            <div class="timer" id="timeDisplay">25:00</div>

            <div class="progress-container">
                <div class="bar" id="progressBar"></div>
            </div>

            <div class="controls">
                <button class="btn-start" onclick="startTimer()">START</button>
                <button class="btn-pause" onclick="pauseTimer()">PAUSE</button>
                <button class="btn-reset" onclick="resetTimer()">RESET</button>
            </div>

            <div style="margin-top: 25px; padding: 15px; background: #f8fafc; border-radius: 15px;">
                <label>Voice Volume ðŸ”Š</label>
                <input type="range" id="volumeControl" min="0" max="1" step="0.1" value="1" style="width: 100%;">
            </div>

            <div class="settings-grid">
                <div>
                    <label>Focus (Min)</label>
                    <input type="number" id="focusInput" value="25" min="1" onchange="applySettings()">
                </div>
                <div>
                    <label>Break (Min)</label>
                    <input type="number" id="breakInput" value="5" min="1" onchange="applySettings()">
                </div>
            </div>
        </div>
    </main>

    <aside class="right-panel">
        <h3 style="margin-bottom: 20px;">Performance</h3>
        <div class="stats-box">
            <span class="stat-val" id="sessions">0</span>
            <span style="font-size: 0.8rem; font-weight: 700; color: var(--text-muted);">Completed Sessions</span>
        </div>
        <div class="stats-box">
            <span class="stat-val" id="studyTime">0</span>
            <span style="font-size: 0.8rem; font-weight: 700; color: var(--text-muted);">Total Focus Minutes</span>
        </div>

        <div style="background: #fdf2f8; padding: 20px; border-radius: 20px; border: 1px solid #fce7f3; margin-top: 20px;">
            <h4 style="color: #db2777; font-size: 0.9rem;">Voice Assistant</h4>
            <p style="font-size: 0.75rem; color: #9d174d; margin-top: 5px; line-height: 1.4;">
                I will announce when your session ends so you don't have to keep checking the screen!
            </p>
        </div>
    </aside>

    <script>
        let timeLeft;
        let totalSessionTime;
        let isFocusMode = true;
        let timerInterval = null;

        let sessions = parseInt(localStorage.getItem("sessions")) || 0;
        let studyTime = parseInt(localStorage.getItem("studyTime")) || 0;

        const display = document.getElementById("timeDisplay");
        const bar = document.getElementById("progressBar");
        const modeHeader = document.getElementById("modeText");
        const volumeSlider = document.getElementById("volumeControl");

        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.volume = parseFloat(volumeSlider.value);
                window.speechSynthesis.speak(utterance);
            }
        }

        function updateStatsDisplay() {
            document.getElementById("sessions").innerText = sessions;
            document.getElementById("studyTime").innerText = studyTime;
        }

        function displayTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            const formatted = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            display.innerText = formatted;
            document.title = `${formatted} - ${isFocusMode ? 'Focus' : 'Break'}`;
            const percent = ((totalSessionTime - seconds) / totalSessionTime) * 100;
            bar.style.width = `${percent}%`;
            bar.style.background = isFocusMode ? "var(--primary)" : "var(--success)";
        }

        function applySettings() {
            if (timerInterval) return; 
            const focusMins = parseInt(document.getElementById("focusInput").value) || 25;
            const breakMins = parseInt(document.getElementById("breakInput").value) || 5;
            timeLeft = (isFocusMode ? focusMins : breakMins) * 60;
            totalSessionTime = timeLeft;
            displayTime(timeLeft);
        }

        function showToast(msg) {
            const toast = document.getElementById("toast");
            toast.innerText = msg;
            toast.classList.add("show");
            setTimeout(() => toast.classList.remove("show"), 4000);
        }

        function startTimer() {
            if (timerInterval) return;
            display.classList.remove("pulse");
            timerInterval = setInterval(() => {
                timeLeft--;
                displayTime(timeLeft);
                if (timeLeft <= 0) handleTransition();
            }, 1000);
        }

        function pauseTimer() {
            clearInterval(timerInterval);
            timerInterval = null;
        }

        function resetTimer() {
            pauseTimer();
            isFocusMode = true;
            display.classList.remove("pulse");
            modeHeader.innerText = "Focus Session";
            applySettings();
        }

        function handleTransition() {
            pauseTimer();
            display.classList.add("pulse");
            const focusMins = parseInt(document.getElementById("focusInput").value);
            const breakMins = parseInt(document.getElementById("breakInput").value);

            if (isFocusMode) {
                sessions++;
                studyTime += focusMins;
                localStorage.setItem("sessions", sessions);
                localStorage.setItem("studyTime", studyTime);
                speak("Focus session complete. Take a break.");
                showToast("Focus Complete! â˜•");
                isFocusMode = false;
                modeHeader.innerText = "Break Time";
                timeLeft = breakMins * 60;
            } else {
                speak("Break over. Get back to work.");
                showToast("Break Over! ðŸ’ª");
                isFocusMode = true;
                modeHeader.innerText = "Focus Session";
                timeLeft = focusMins * 60;
            }
            totalSessionTime = timeLeft;
            updateStatsDisplay();
            displayTime(timeLeft);
        }

        // Init
        timeLeft = 25 * 60;
        totalSessionTime = 25 * 60;
        updateStatsDisplay();
        displayTime(timeLeft);
    </script>
</body>
</html>